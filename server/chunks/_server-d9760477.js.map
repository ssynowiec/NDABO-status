{"version":3,"file":"_server-d9760477.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/embed-_tag_/js/_server.js"],"sourcesContent":["import { p as public_env } from \"../../../../chunks/shared-server.js\";\nimport fs from \"fs-extra\";\nJSON.parse(fs.readFileSync(public_env.PUBLIC_KENER_FOLDER + \"/site.json\", \"utf8\"));\nasync function GET({ url, params }) {\n  const { tag } = params;\n  const query = url.searchParams;\n  const uriEmbedded = query.get(\"monitor\");\n  const theme = query.get(\"theme\") || \"light\";\n  const uriOriginal = uriEmbedded;\n  const currentSlug = tag;\n  const js = `\n\t(function () {\n    var createEmbedFrame = function () {\n        var uid = \"KENER_\" + ~~(new Date().getTime() / 86400000);\n        var uriOriginal = \"${uriOriginal}\";\n        var uriOriginalNoProtocol = uriOriginal.split(\"//\").pop();\n        var uriEmbedded = \"${uriEmbedded}?theme=${theme}\";\n        var currentSlug = \"${currentSlug}\";\n        var target = document.querySelector(\"script[src*='\" + uriOriginalNoProtocol + \"']\");\n        var iframe = document.createElement(\"iframe\");\n\n        iframe.src = uriEmbedded;\n        iframe.id = uid;\n        iframe.width = \"0%\";\n        iframe.height = \"0\";\n        iframe.frameBorder = \"0\";\n        iframe.allowtransparency = true;\n        iframe.sandbox = \"allow-modals allow-forms allow-same-origin allow-scripts allow-popups allow-top-navigation-by-user-activation allow-downloads\";\n        iframe.allow = \"midi; geolocation; microphone; camera; display-capture; encrypted-media;\";\n\n        target.parentNode.insertBefore(iframe, target.nextSibling);\n\n        var setHeight = function (data) {\n\t\n            if (data.slug === currentSlug) {\n                var height = data.height;\n                iframe.height = height;\n            }\n        };\n        var setWidth = function (data) {\n\t\t\n            if (data.slug === currentSlug) {\n                var width = data.width;\n                iframe.width = width;\n            }\n        };\n\n        var listeners = function (event) {\n            var eventName = event.data[0];\n            var data = event.data[1];\n\t\t\tif(event.data.height !== undefined) {\n\t\t\t\tsetHeight(event.data);\n\t\t\t}\n\t\t\tif(event.data.width !== undefined) {\n\t\t\t\tsetWidth(event.data);\n\t\t\t}\n            \n        };\n\n        window.addEventListener(\"message\", listeners, false);\n    };\n\n    setTimeout(createEmbedFrame, 5);\n}).call(this);\n\n\t`;\n  return new Response(js, {\n    headers: {\n      \"Content-Type\": \"application/javascript\"\n    }\n  });\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;AAEA,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,mBAAmB,GAAG,YAAY,EAAE,MAAM,CAAC,CAAC,CAAC;AACnF,eAAe,GAAG,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE;AACpC,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,CAAC;AACzB,EAAE,MAAM,KAAK,GAAG,GAAG,CAAC,YAAY,CAAC;AACjC,EAAE,MAAM,WAAW,GAAG,KAAK,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;AAC3C,EAAE,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC;AAC9C,EAAE,MAAM,WAAW,GAAG,WAAW,CAAC;AAClC,EAAE,MAAM,WAAW,GAAG,GAAG,CAAC;AAC1B,EAAE,MAAM,EAAE,GAAG,CAAC;AACd;AACA;AACA;AACA,2BAA2B,EAAE,WAAW,CAAC;AACzC;AACA,2BAA2B,EAAE,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC;AACxD,2BAA2B,EAAE,WAAW,CAAC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAAC,CAAC;AACH,EAAE,OAAO,IAAI,QAAQ,CAAC,EAAE,EAAE;AAC1B,IAAI,OAAO,EAAE;AACb,MAAM,cAAc,EAAE,wBAAwB;AAC9C,KAAK;AACL,GAAG,CAAC,CAAC;AACL;;;;"}